(this["webpackJsonptest-app"]=this["webpackJsonptest-app"]||[]).push([[0],{114:function(e,t,n){},139:function(e,t,n){},142:function(e,t,n){},143:function(e,t,n){},144:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(26),s=n.n(r),i=(n(114),n(19)),u=n.n(i),o=n(32),l=n(52),d=n(42),b=n.n(d),j=function e(){var t=this;Object(l.a)(this,e),this._apiBase="https://dispex.org/api/vtest",this.getResource=function(){var e=Object(o.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("".concat(t._apiBase).concat(n));case 2:if(!((a=e.sent).status>=400)){e.next=5;break}throw new Error("Could not fetch ".concat(n,", received ").concat(a.status));case 5:return e.next=7,a;case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getStreets=Object(o.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/Request/streets");case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)}))),this.getHouses=function(){var e=Object(o.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/Request/houses/".concat(n));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getFlats=function(){var e=Object(o.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/Request/house_flats/".concat(n));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.postPerson=function(){var e=Object(o.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"text/json",accept:"text/plain"},data:t,url:"https://dispex.org/api/vtest/HousingStock/client"},e.next=3,b()(n);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getAllTenants=function(){var e=Object(o.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("https://dispex.org/api/vtest/HousingStock/clients?addressId="+t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.bindPerson=function(){var e=Object(o.a)(u.a.mark((function e(t,n){var a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"PUT",headers:{"Content-Type":"text/json",accept:"*/*"},data:{AddressId:t,ClientId:n},url:"https://dispex.org/api/vtest/HousingStock/bind_client"},e.next=3,b()(a);case 3:return c=e.sent,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.removePerson=function(){var e=Object(o.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.delete("https://dispex.org/api/vtest/HousingStock/bind_client/".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},f=n(27),h=n(14),p=n(12),O=n(201),x=n(204),m=n(203),v=n(196),g=n(148),S=n(193),E=n(198),T=n(200),w=n(199),C=n(188),k=function(e){return{type:"SET_CLIENT_LIST",clientList:e}},y=(n(139),n(2)),I=new j,F={setClientList:k},L=Object(f.b)((function(e){return{selectedFlat:e.selectedFlat}}),F)((function(e){var t=e.name,n=e.phone,c=e.email,r=e.bindId,s=e.selectedFlat,i=e.setClientList,u={Id:0,Name:t,Phone:n,Email:c,BindId:0},o=Object(a.useState)(!1),l=Object(p.a)(o,2),d=l[0],b=l[1],j=Object(a.useState)(u),f=Object(p.a)(j,2),k=f[0],F=f[1],L=function(){b(!1),I.getAllTenants(s.id).then((function(e){i(e.data)}))};return Object(y.jsxs)("div",{className:"personInfo",children:[Object(y.jsxs)(O.a,{sx:{minWidth:275,maxWidth:500,minHeight:200},children:[Object(y.jsxs)(m.a,{children:[Object(y.jsx)(g.a,{sx:{fontSize:20},color:"text.secondary",gutterBottom:!0,children:t}),Object(y.jsx)(g.a,{sx:{fontSize:20},color:"green",children:n}),Object(y.jsx)(g.a,{sx:{mb:1.5},color:"text.secondary",children:c})]}),Object(y.jsxs)(x.a,{children:[Object(y.jsx)(v.a,{size:"small",onClick:function(){b(!0),F(u)},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(y.jsx)(v.a,{size:"small",onClick:function(){return e=r,void I.removePerson(e).then((function(){I.getAllTenants(s.id).then((function(e){""!==e.data?i(e.data):i([])}))}));var e},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})]}),Object(y.jsxs)(E.a,{open:d,onClose:L,children:[Object(y.jsx)(C.a,{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"}),Object(y.jsxs)(w.a,{children:[Object(y.jsx)(S.a,{id:"outlined-name",label:"Name",onChange:function(e){F((function(t){return Object(h.a)(Object(h.a)({},t),{},{Name:e.target.value})}))},value:k.Name}),Object(y.jsx)(S.a,{id:"outlined-basic",label:"Email",variant:"outlined",value:k.Email,onChange:function(e){F((function(t){return Object(h.a)(Object(h.a)({},t),{},{Email:e.target.value})}))}})]}),Object(y.jsxs)(T.a,{children:[Object(y.jsx)(v.a,{onClick:L,children:"Cancel"}),Object(y.jsx)(v.a,{onClick:function(){return function(e){I.postPerson(e).then((function(){I.getAllTenants(s.id).then((function(e){i(e.data)}))})),b(!1)}(k)},children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"})]})]})]})})),P=n(191),_=n(192),N=(n(142),new j),A={setHouses:function(e){return{type:"SET_HOUSES",houses:e}},setFlats:function(e){return{type:"SET_FLATS",flats:e}},setSelectedFlat:function(e){return{type:"SET_SELECTED_FLAT",selectedFlat:e}},setClientList:k},H=Object(f.b)((function(e){return{streets:e.streets,houses:e.houses,flats:e.flats,selectedFlat:e.selectedFlat,clientList:e.clientList}}),A)((function(e){var t=e.streets,n=e.houses,c=e.setHouses,r=e.flats,s=e.setFlats,i=e.selectedFlat,u=e.setSelectedFlat,o=e.clientList,l=e.setClientList,d=Object(a.useState)(""),b=Object(p.a)(d,2),j=b[0],f=b[1],O=Object(a.useState)(""),x=Object(p.a)(O,2),m=x[0],v=x[1];Object(a.useEffect)((function(){g(j),E(m)}),[j,m]);var g=function(e){var n=t.find((function(t){return t.name===e}));n&&N.getHouses(n.id).then((function(e){c(e)}))},E=function(e){var t=n.find((function(t){return t.name===e}));t&&N.getFlats(t.id).then((function(e){s(e)}))},T=function(e){v(e.target.value)},w=function(e){f(e.target.value)},C=function(e){var t,n=null===r||void 0===r?void 0:r.find((function(t){return t.name===e.target.value}));u(n),(t=null===n||void 0===n?void 0:n.id)&&N.getAllTenants(t).then((function(e){200===e.status?l(e.data):l([])})),n||l([])},k=t.map((function(e){return{label:e.name,id:e.id}})),I=0===t.length;return Object(y.jsxs)("div",{className:"form",children:[Object(y.jsxs)(P.a,{direction:"row",spacing:2,children:[Object(y.jsx)(_.a,{disablePortal:!0,id:"combo-box",isOptionEqualToValue:function(e,t){return e.label===t.label},loading:I,options:k,sx:{width:300},renderOption:function(e,t){return Object(a.createElement)("li",Object(h.a)(Object(h.a)({},e),{},{key:t.id}),t.label)},renderInput:function(e){return Object(y.jsx)(S.a,Object(h.a)(Object(h.a)({},e),{},{onSelect:w,label:"\u0423\u043b\u0438\u0446\u0430"}))}}),Object(y.jsx)(_.a,{disablePortal:!0,id:"combo-box",isOptionEqualToValue:function(e,t){return e.label===t.label},options:n.map((function(e){return{label:e.name,id:e.id}})),sx:{width:300},renderOption:function(e,t){return Object(a.createElement)("li",Object(h.a)(Object(h.a)({},e),{},{key:t.id}),t.label)},renderInput:function(e){return Object(y.jsx)(S.a,Object(h.a)(Object(h.a)({},e),{},{onSelect:T,label:"\u0414\u043e\u043c"}))}}),Object(y.jsx)(_.a,{disablePortal:!0,id:"combo-box",isOptionEqualToValue:function(e,t){return e.label===t.label},options:r.map((function(e){return{label:e.name,typeName:e.typeName,id:e.id}})),sx:{width:300},renderOption:function(e,t){if("\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430"===t.typeName)return Object(a.createElement)("li",Object(h.a)(Object(h.a)({},e),{},{key:t.id}),t.label)},renderInput:function(e){return Object(y.jsx)(S.a,Object(h.a)(Object(h.a)({},e),{},{onSelect:C,label:"\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430"}))}})]}),i?Object(y.jsx)("h4",{style:{fontWeight:500,fontSize:20},children:"\u0416\u0438\u043b\u044c\u0446\u044b ".concat(j," ").concat(m," \u043a\u0432\u0430\u0440\u0442\u0438\u0440\u0430: ").concat(i.name," :")}):null,Object(y.jsx)("div",{className:"personInfo",children:o.map((function(e,t){var n=e.name,a=e.phone,c=e.email,r=e.bindId;return Object(y.jsx)(L,{bindId:r,name:n,phone:a,email:c},t)}))})]})})),R=(n(143),new j),B={setClientList:k},q=Object(f.b)((function(e){return{selectedFlat:e.selectedFlat}}),B)((function(e){var t=e.selectedFlat,n=e.setClientList,c=Object(a.useState)(!1),r=Object(p.a)(c,2),s=r[0],i=r[1],u=Object(a.useState)({Id:0,Name:"",Phone:"",Email:"",BindId:0}),o=Object(p.a)(u,2),l=o[0],d=o[1],b=function(e,a){R.bindPerson(e,a).then((function(){R.getAllTenants(t.id).then((function(e){n(e.data)}))}))},j=function(){i(!1),d({Id:0,Name:"",Phone:"",Email:"",BindId:0}),R.getAllTenants(t.id).then((function(e){n(e.data)}))};return Object(y.jsxs)("div",{children:[Object(y.jsx)(v.a,{variant:"outlined",onClick:function(){i(!0)},sx:{position:"absolute",top:30,right:100},disabled:!t,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"}),Object(y.jsxs)(E.a,{open:s,onClose:j,children:[Object(y.jsx)(C.a,{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"}),Object(y.jsxs)(w.a,{children:[Object(y.jsx)(S.a,{id:"outlined-name",label:"\u0424.\u0418.\u041e",sx:{m:1,width:"25ch"},onChange:function(e){d((function(t){return Object(h.a)(Object(h.a)({},t),{},{Name:e.target.value})}))},value:l.Name}),Object(y.jsx)(S.a,{id:"outlined-basic",label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",required:!0,variant:"outlined",sx:{m:1,width:"25ch"},value:l.Phone,onChange:function(e){d((function(t){return Object(h.a)(Object(h.a)({},t),{},{Phone:e.target.value})}))}}),Object(y.jsx)(S.a,{id:"outlined-basic",label:"Email",variant:"outlined",sx:{m:1,width:"25ch"},value:l.Email,onChange:function(e){d((function(t){return Object(h.a)(Object(h.a)({},t),{},{Email:e.target.value})}))}})]}),Object(y.jsxs)(T.a,{children:[Object(y.jsx)(v.a,{onClick:j,children:"Cancel"}),Object(y.jsx)(v.a,{disabled:!l.Phone,onClick:function(){return function(e){R.postPerson(e).then((function(e){b(t.id,e.data.id)})),d({Id:0,Name:"",Phone:"",Email:"",BindId:0}),i(!1)}(l)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]})]})]})})),z=new j,U={setStreets:function(e){return{type:"SET_STREETS",streets:e}}},V=Object(f.b)((function(e){return{streets:e.streets,houses:e.houses,flats:e.flats}}),U)((function(e){var t=e.setStreets;Object(a.useEffect)((function(){n()}),[]);var n=function(){z.getStreets().then((function(e){t(e)}))};return Object(y.jsxs)("div",{className:"app",children:[Object(y.jsx)(H,{}),Object(y.jsx)(q,{})]})})),W=n(87),D={streets:[],houses:[],selectedHouse:null,flats:[],selectedFlat:null,clientList:[]},J=Object(W.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_STREETS":return Object(h.a)(Object(h.a)({},e),{},{streets:t.streets});case"SET_HOUSES":return Object(h.a)(Object(h.a)({},e),{},{houses:t.houses});case"SET_FLATS":return Object(h.a)(Object(h.a)({},e),{},{flats:t.flats});case"SET_SELECTED_FLAT":return Object(h.a)(Object(h.a)({},e),{},{selectedFlat:t.selectedFlat});case"SET_CLIENT_LIST":return Object(h.a)(Object(h.a)({},e),{},{clientList:t.clientList});default:return e}})),M=J;s.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(f.a,{store:M,children:Object(y.jsx)(V,{})})}),document.getElementById("root"))}},[[144,1,2]]]);
//# sourceMappingURL=main.215a02ed.chunk.js.map