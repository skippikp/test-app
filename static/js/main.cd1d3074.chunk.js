(this["webpackJsonptest-app"]=this["webpackJsonptest-app"]||[]).push([[0],{119:function(e,t,n){},146:function(e,t,n){},147:function(e,t,n){},148:function(e,t,n){},149:function(e,t,n){},150:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(26),s=n.n(r),i=(n(119),n(11)),o=n(17),u=n.n(o),l=n(30),d=n(39),h=n(49),b=n.n(h),f=new function e(){var t=this;Object(d.a)(this,e),this._apiBase="https://dispex.org/api/vtest",this.getResource=function(){var e=Object(l.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("".concat(t._apiBase).concat(n));case 2:if(!((a=e.sent).status>=400)){e.next=5;break}throw new Error("Could not fetch ".concat(n,", received ").concat(a.status));case 5:return e.next=7,a;case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getStreets=Object(l.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/Request/streets");case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)}))),this.getHouses=function(){var e=Object(l.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/Request/houses/".concat(n));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getFlats=function(){var e=Object(l.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/Request/house_flats/".concat(n));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getPersonByPhone=function(){var e=Object(l.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/HousingStock/client?phone=".concat(n));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.postPerson=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"text/json",accept:"text/plain"},data:t,url:"https://dispex.org/api/vtest/HousingStock/client"},e.next=3,b()(n);case 3:if(!((a=e.sent).status>=400)){e.next=6;break}throw new Error("Could not fetch ".concat(n.url,", received ").concat(a.status));case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getAllTenants=function(){var e=Object(l.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/HousingStock/clients?addressId=".concat(n));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.bindPerson=function(){var e=Object(l.a)(u.a.mark((function e(t,n){var a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"PUT",headers:{"Content-Type":"text/json",accept:"*/*"},data:{AddressId:t,ClientId:n},url:"https://dispex.org/api/vtest/HousingStock/bind_client"},e.next=3,b()(a);case 3:if(!((c=e.sent).status>=400)){e.next=6;break}throw new Error("Could not fetch ".concat(a.url,", received ").concat(c.status));case 6:return e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.removePerson=function(){var e=Object(l.a)(u.a.mark((function e(n){var a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(t._apiBase,"/HousingStock/bind_client/").concat(n),e.next=3,b.a.delete(a);case 3:if(!((c=e.sent).status>=400)){e.next=6;break}throw new Error("Could not fetch ".concat(a,", received ").concat(c.status));case 6:return e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},j=f,p=n(199),O=n(14),x=n(202),m=n(201),v=n(2),g=function(e){var t=e.onOpen,n=e.loading,c=e.options,r=e.onChange,s=e.label,i=e.value;return Object(v.jsx)(x.a,{id:"select-component",onOpen:t,value:i,onChange:function(e,t){r(t)},isOptionEqualToValue:function(e,t){return e.label===t||e.label===(null===t||void 0===t?void 0:t.label)},loading:n,options:c,sx:{width:{xs:100,sm:150,md:200,lg:250,xl:300}},renderOption:function(e,t){return Object(a.createElement)("li",Object(O.a)(Object(O.a)({},e),{},{key:t.id}),t.label)},renderInput:function(e){return Object(v.jsx)(m.a,Object(O.a)(Object(O.a)({},e),{},{label:s}))}})},S="SET_STREETS",E="SET_HOUSES",w="SET_FLATS",C="SET_SELECTED_FLAT",y="SET_SELECTED_STREET",T="SET_CLIENT_LIST",k="SET_SELECTED_HOUSE",H=function(e){return{type:T,clientList:e}},F=n(33),P=(n(146),n(209)),L=n(211),I=n(210),_=n(206),A=n(156),N=function(e){var t=e.name,n=e.phone,a=e.email,c=e.handleEdit,r=e.handleRemove;return Object(v.jsxs)(P.a,{sx:{minWidth:150,maxWidth:500,minHeight:200},children:[Object(v.jsxs)(I.a,{children:[Object(v.jsx)(A.a,{sx:{fontSize:20},color:"text.secondary",gutterBottom:!0,children:t}),Object(v.jsx)(A.a,{sx:{fontSize:20},color:"green",children:n}),Object(v.jsx)(A.a,{sx:{mb:1.5},color:"text.secondary",children:a})]}),Object(v.jsxs)(L.a,{children:[Object(v.jsx)(_.a,{size:"small",onClick:c,children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(v.jsx)(_.a,{size:"small",onClick:r,children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})]})},B=n(212),R=n(214),q=n(213),z=n(198),D=function(e){var t=e.open,n=e.onClose,a=e.title,c=e.disabled,r=e.handleSubmit,s=e.submitButtonName,i=e.inputs;return Object(v.jsxs)(B.a,{open:t,onClose:n,children:[Object(v.jsx)(z.a,{children:a}),Object(v.jsx)(q.a,{children:i.map((function(e,t){return Object(v.jsx)(m.a,Object(O.a)({},e),t)}))}),Object(v.jsxs)(R.a,{children:[Object(v.jsx)(_.a,{onClick:n,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),Object(v.jsx)(_.a,{disabled:c,onClick:r,children:s})]})]})},U={setClientList:H},W=Object(F.b)((function(e){return{selectedFlat:e.selectedFlat}}),U)((function(e){var t=e.person,n=e.selectedFlat,c=e.setClientList,r=t.name,s=t.phone,o=t.email,u=t.bindId,l=Object(a.useState)(!1),d=Object(i.a)(l,2),h=d[0],b=d[1],f=Object(a.useState)(t),p=Object(i.a)(f,2),x=p[0],m=p[1],g=function(e){j.removePerson(e).then((function(){j.getAllTenants(n.id).then((function(e){""!==e.data&&200===e.status?c(e.data):c([])}))}))},S=function(e){return/^((8|\+7)[\- ]?)?(\(?\d{3,4}\)?[\- ]?)?[\d\- ]{5,10}$/.test(e)},E=[{id:"outlined-name",label:"\u0418\u043c\u044f",sx:{m:1,width:"25ch"},onChange:function(e){m((function(t){return Object(O.a)(Object(O.a)({},t),{},{name:e.target.value})}))},value:x.name},{id:"outlined-basic",label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",type:"tel",required:!0,variant:"outlined",sx:{m:1,width:"25ch"},error:!S(x.phone),value:x.phone,onChange:function(e){m((function(t){return Object(O.a)(Object(O.a)({},t),{},{phone:e.target.value})}))}},{id:"outlined-basic",label:"Email",sx:{m:1,width:"25ch"},variant:"outlined",value:x.email,onChange:function(e){m((function(t){return Object(O.a)(Object(O.a)({},t),{},{email:e.target.value})}))}}];return Object(v.jsxs)("div",{className:"personInfo",children:[Object(v.jsx)(N,{name:r,phone:s,email:o,handleEdit:function(){b(!0),m(t)},handleRemove:function(){return g(u)}}),Object(v.jsx)(D,{open:h,onClose:function(){b(!1),j.getAllTenants(n.id).then((function(e){""!==e.data&&200===e.status?c(e.data):c([])}))},title:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0436\u0438\u043b\u044c\u0446\u0430",disabled:!x.phone||!S(x.phone),submitButtonName:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c",handleSubmit:function(){return j.postPerson(x).then((function(e){e.data.id!==x.id&&j.bindPerson(n.id,e.data.id).then((function(){g(t.bindId)})),j.getAllTenants(n.id).then((function(e){""!==e.data&&200===e.status?c(e.data):c([])}))})),void b(!1)},inputs:E})]})})),J={setAllHouses:function(e){return{type:E,houses:e}},setAllFlats:function(e){return{type:w,flats:e}},setSelectedFlat:function(e){return{type:C,selectedFlat:e}},setClientList:H,setAllStreets:function(e){return{type:S,streets:e}},setSelectedStreet:function(e){return{type:y,selectedStreet:e}},setSelectedHouse:function(e){return{type:k,selectedHouse:e}}},$=Object(F.b)((function(e){var t=e.streets,n=e.houses,a=e.flats,c=e.selectedFlat,r=e.selectedStreet;return{streets:t,houses:n,flats:a,selectedFlat:c,clientList:e.clientList,selectedStreet:r,selectedHouse:e.selectedHouse}}),J)((function(e){var t=e.streets,n=e.houses,r=e.setAllHouses,s=e.flats,o=e.setAllFlats,u=e.selectedFlat,l=e.setSelectedFlat,d=e.clientList,h=e.setClientList,b=e.setAllStreets,f=e.setSelectedStreet,O=e.selectedStreet,x=e.setSelectedHouse,m=e.selectedHouse,S=Object(a.useState)(""),E=Object(i.a)(S,2),w=E[0],C=E[1],y=t.map((function(e){return{label:e.name,id:e.id}})),T=n.map((function(e){return{label:e.name,id:e.id}})),k=s.map((function(e){return{label:e.name,id:e.id}}));return Object(v.jsxs)("div",{className:"form",children:[Object(v.jsxs)(p.a,{direction:{xs:"column",sm:"row"},alignItems:"center",spacing:2,children:[Object(v.jsx)(g,{onOpen:function(){j.getStreets().then((function(e){b(e)})).catch((function(e){return console.log("\u041d\u0435 \u0443\u0434\u0430\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 "+e)}))},loading:0===t.length,options:y,onChange:function(e){f(null===e?"":e.label),function(e){e&&j.getHouses(e.id).then((function(e){r(e)})).catch((function(e){return console.log("\u041d\u0435 \u0443\u0434\u0430\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 "+e)}))}(e),l(""),C(""),x(""),h([])},label:"\u0423\u043b\u0438\u0446\u0430"}),Object(v.jsx)(g,{options:T,onChange:function(e){x(null===e?"":e.label),function(e){e&&j.getFlats(e.id).then((function(e){var t=e.filter((function(e){return"\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430"===e.typeName}));o(t)})).catch((function(e){return console.log("\u041d\u0435 \u0443\u0434\u0430\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 "+e)}))}(e),l(""),C(""),h([])},label:"\u0414\u043e\u043c",value:m}),Object(v.jsx)(g,{options:k,onChange:function(e){if(null===e)return l(""),C(""),void h([]);var t;l(e),C(e.label),(t=e.id)&&j.getAllTenants(t).then((function(e){""!==e.data&&200===e.status?h(e.data):h([])})).catch((function(e){return console.log("\u041d\u0435 \u0443\u0434\u0430\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 "+e)}))},label:"\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430",value:w})]}),u?Object(v.jsxs)(c.a.Fragment,{children:[Object(v.jsx)("h4",{style:{fontWeight:500,fontSize:20},children:"\u0416\u0438\u043b\u044c\u0446\u044b ".concat(O," ").concat(m," \u043a\u0432\u0430\u0440\u0442\u0438\u0440\u0430: ").concat(u.label," :")}),Object(v.jsx)("div",{className:"personInfo",children:d.map((function(e,t){return Object(v.jsx)(W,{person:e},t)}))})]}):null]})})),M=(n(147),n(205)),V=(n(148),{setClientList:H}),G=Object(F.b)((function(e){return{selectedFlat:e.selectedFlat,selectedStreet:e.selectedStreet,selectedHouse:e.selectedHouse}}),V)((function(e){var t,n=e.selectedFlat,c=e.setClientList,r=e.selectedStreet,s=e.selectedHouse,o=Object(a.useState)(!1),u=Object(i.a)(o,2),l=u[0],d=u[1],h=Object(a.useState)({Id:0,Name:"",Phone:"",Email:"",BindId:0}),b=Object(i.a)(h,2),f=b[0],p=b[1],x=Object(a.useState)(!1),m=Object(i.a)(x,2),g=m[0],S=m[1],E=function(e){j.postPerson(e).then((function(e){var t,a;t=n.id,a=e.data.id,j.bindPerson(t,a).then((function(){j.getAllTenants(n.id).then((function(e){""!==e.data&&200===e.status?c(e.data):c([])}))})).catch((function(e){return console.log("\u041d\u0435 \u0443\u0434\u0430\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 "+e)}))})).catch((function(e){return console.log("\u041d\u0435 \u0443\u0434\u0430\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 "+e)})),p({Id:0,Name:"",Phone:"",Email:"",BindId:0}),S(!1),d(!1)},w=function(){d(!0)},C=(t=f.Phone,!/^((8|\+7)[\- ]?)?(\(?\d{3,4}\)?[\- ]?)?[\d\- ]{5,10}$/.test(t)||g),y=[{id:"outlined-name",label:"\u0424.\u0418.\u041e",sx:{m:1,width:"25ch"},onChange:function(e){p((function(t){return Object(O.a)(Object(O.a)({},t),{},{Name:e.target.value})}))},value:f.Name},{id:"outlined-basic",label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",type:"tel",required:!0,variant:"outlined",sx:{m:1,width:"25ch"},error:C,helperText:g?"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0434\u0430\u043d\u043d\u044b\u043c \u043d\u043e\u043c\u0435\u0440\u043e\u043c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442.":!!C&&"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",value:f.Phone,onChange:function(e){j.getPersonByPhone(e.target.value).then((function(e){e.id?S(!0):S(!1)})),p((function(t){return Object(O.a)(Object(O.a)({},t),{},{Phone:e.target.value})}))}},{id:"outlined-basic",label:"Email",variant:"outlined",sx:{m:1,width:"25ch"},value:f.Email,onChange:function(e){p((function(t){return Object(O.a)(Object(O.a)({},t),{},{Email:e.target.value})}))}}];return Object(v.jsxs)("div",{className:"person_modal",children:["\u0424\u0435\u0434\u044e\u043d\u0438\u043d\u0441\u043a\u043e\u0433\u043e"===r&&s.includes("30")?Object(v.jsx)(_.a,{variant:"outlined",onClick:w,disabled:!n,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"}):Object(v.jsx)(M.a,{title:"\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u043e\u0432 \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0443\u043b\u0438\u0446\u044b \u0424\u0435\u0434\u044e\u043d\u0438\u043d\u0441\u043a\u043e\u0433\u043e 30, \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u043a\u043e\u0440\u043f\u0443\u0441\u043e\u0432",children:Object(v.jsx)("span",{children:Object(v.jsx)(_.a,{variant:"outlined",onClick:w,disabled:!0,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"})})}),Object(v.jsx)(D,{open:l,onClose:function(){d(!1),S(!1),p({Id:0,Name:"",Phone:"",Email:"",BindId:0}),j.getAllTenants(n.id).then((function(e){""!==e.data&&200===e.status?c(e.data):c([])})).catch((function(e){return console.log("\u041d\u0435 \u0443\u0434\u0430\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 "+e)}))},title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430",disabled:!f.Phone||C,handleSubmit:function(){return E(f)},submitButtonName:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",inputs:y})]})})),K=n(59),Q=n(96),X=n(93),Y=(n(149),function(e){Object(Q.a)(n,e);var t=Object(X.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={hasError:!1},e}return Object(K.a)(n,[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?Object(v.jsxs)("div",{className:"error",children:[Object(v.jsx)("h2",{children:"Sorry"}),Object(v.jsx)("h3",{children:"something goes wrong"})]}):this.props.children}}]),n}(c.a.Component)),Z=Y,ee=function(){return Object(v.jsx)("div",{className:"app",children:Object(v.jsxs)(Z,{children:[Object(v.jsx)($,{}),Object(v.jsx)(G,{})]})})},te=n(94),ne={streets:[],houses:[],flats:[],selectedFlat:"",clientList:[],selectedStreet:"",selectedHouse:""},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return Object(O.a)(Object(O.a)({},e),{},{streets:t.streets});case E:return Object(O.a)(Object(O.a)({},e),{},{houses:t.houses});case w:return Object(O.a)(Object(O.a)({},e),{},{flats:t.flats});case C:return Object(O.a)(Object(O.a)({},e),{},{selectedFlat:t.selectedFlat});case k:return Object(O.a)(Object(O.a)({},e),{},{selectedHouse:t.selectedHouse});case T:return Object(O.a)(Object(O.a)({},e),{},{clientList:t.clientList});case y:return Object(O.a)(Object(O.a)({},e),{},{selectedStreet:t.selectedStreet});default:return e}},ce=Object(te.a)(ae);s.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(F.a,{store:ce,children:Object(v.jsx)(ee,{})})}),document.getElementById("root"))}},[[150,1,2]]]);
//# sourceMappingURL=main.cd1d3074.chunk.js.map