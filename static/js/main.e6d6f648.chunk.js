(this["webpackJsonptest-app"]=this["webpackJsonptest-app"]||[]).push([[0],{115:function(e,t,n){},142:function(e,t,n){},143:function(e,t,n){},144:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(26),s=n.n(r),i=(n(115),n(14)),o=n(11),l=n(19),u=n.n(l),d=n(31),b=n(53),h=n(42),j=n.n(h),f=function e(){var t=this;Object(b.a)(this,e),this._apiBase="https://dispex.org/api/vtest",this.getResource=function(){var e=Object(d.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("".concat(t._apiBase).concat(n));case 2:if(!((a=e.sent).status>=400)){e.next=5;break}throw new Error("Could not fetch ".concat(n,", received ").concat(a.status));case 5:return e.next=7,a;case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getStreets=Object(d.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/Request/streets");case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)}))),this.getHouses=function(){var e=Object(d.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/Request/houses/".concat(n));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getFlats=function(){var e=Object(d.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getResource("/Request/house_flats/".concat(n));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.postPerson=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"text/json",accept:"text/plain"},data:t,url:"https://dispex.org/api/vtest/HousingStock/client"},e.next=3,j()(n);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getAllTenants=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("https://dispex.org/api/vtest/HousingStock/clients?addressId="+t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.bindPerson=function(){var e=Object(d.a)(u.a.mark((function e(t,n){var a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"PUT",headers:{"Content-Type":"text/json",accept:"*/*"},data:{AddressId:t,ClientId:n},url:"https://dispex.org/api/vtest/HousingStock/bind_client"},e.next=3,j()(a);case 3:return c=e.sent,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.removePerson=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.delete("https://dispex.org/api/vtest/HousingStock/bind_client/".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},p=n(190),O=n(191),x=n(192),m=n(2),v=function(e){var t=e.onOpen,n=e.loading,c=e.options,r=e.onChange,s=e.renderOptions,o=e.label,l=e.value;return Object(m.jsx)(O.a,{id:"select-component",onOpen:t,value:l,onChange:function(e,t){r(t)},isOptionEqualToValue:function(e,t){return e.label===t||e.label===(null===t||void 0===t?void 0:t.label)},loading:n,options:c,sx:{width:300},renderOption:s||function(e,t){return Object(a.createElement)("li",Object(i.a)(Object(i.a)({},e),{},{key:t.id}),t.label)},renderInput:function(e){return Object(m.jsx)(x.a,Object(i.a)(Object(i.a)({},e),{},{label:o}))}})},g="SET_STREETS",C="SET_HOUSES",S="SET_FLATS",w="SET_SELECTED_FLAT",E="SET_CLIENT_LIST",y=function(e){return{type:E,clientList:e}},k=n(32),T=(n(142),n(201)),F=n(203),I=n(202),L=n(195),N=n(148),A=function(e){var t=e.name,n=e.phone,a=e.email,c=e.handleEdit,r=e.handleRemove;return Object(m.jsxs)(T.a,{sx:{minWidth:275,maxWidth:500,minHeight:200},children:[Object(m.jsxs)(I.a,{children:[Object(m.jsx)(N.a,{sx:{fontSize:20},color:"text.secondary",gutterBottom:!0,children:t}),Object(m.jsx)(N.a,{sx:{fontSize:20},color:"green",children:n}),Object(m.jsx)(N.a,{sx:{mb:1.5},color:"text.secondary",children:a})]}),Object(m.jsxs)(F.a,{children:[Object(m.jsx)(L.a,{size:"small",onClick:c,children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(m.jsx)(L.a,{size:"small",onClick:r,children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})]})},P=n(197),_=n(199),H=n(198),R=n(189),B=function(e){var t=e.person,n=e.open,a=e.handleClose,c=e.handleChangeName,r=e.handleChangeEmail,s=e.handleSubmit;return Object(m.jsxs)(P.a,{open:n,onClose:a,children:[Object(m.jsx)(R.a,{children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0436\u0438\u043b\u044c\u0446\u0430"}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(x.a,{id:"outlined-name",label:"\u0418\u043c\u044f",sx:{m:1,width:"25ch"},onChange:c,value:t.Name}),Object(m.jsx)(x.a,{id:"outlined-basic",label:"Email",sx:{m:1,width:"25ch"},variant:"outlined",value:t.Email,onChange:r})]}),Object(m.jsxs)(_.a,{children:[Object(m.jsx)(L.a,{onClick:a,children:"Cancel"}),Object(m.jsx)(L.a,{onClick:function(){return s(t)},children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"})]})]})},q=new f,z={setClientList:y},W=Object(k.b)((function(e){return{selectedFlat:e.selectedFlat}}),z)((function(e){var t=e.name,n=e.phone,c=e.email,r=e.bindId,s=e.selectedFlat,l=e.setClientList,u={Id:0,Name:t,Phone:n,Email:c,BindId:0},d=Object(a.useState)(!1),b=Object(o.a)(d,2),h=b[0],j=b[1],f=Object(a.useState)(u),p=Object(o.a)(f,2),O=p[0],x=p[1];return Object(m.jsxs)("div",{className:"personInfo",children:[Object(m.jsx)(A,{name:t,phone:n,email:c,handleEdit:function(){j(!0),x(u)},handleRemove:function(){return e=r,void q.removePerson(e).then((function(){q.getAllTenants(s.id).then((function(e){""!==e.data?l(e.data):l([])}))}));var e}}),Object(m.jsx)(B,{person:O,open:h,handleClose:function(){j(!1),q.getAllTenants(s.id).then((function(e){l(e.data)}))},handleChangeName:function(e){x((function(t){return Object(i.a)(Object(i.a)({},t),{},{Name:e.target.value})}))},handleChangeEmail:function(e){x((function(t){return Object(i.a)(Object(i.a)({},t),{},{Email:e.target.value})}))},handleSubmit:function(e){q.postPerson(e).then((function(){q.getAllTenants(s.id).then((function(e){l(e.data)}))})),j(!1)}})]})})),J=new f,U={setAllHouses:function(e){return{type:C,houses:e}},setAllFlats:function(e){return{type:S,flats:e}},setSelectedFlat:function(e){return{type:w,selectedFlat:e}},setClientList:y,setAllStreets:function(e){return{type:g,streets:e}}},D=Object(k.b)((function(e){return{streets:e.streets,houses:e.houses,flats:e.flats,selectedFlat:e.selectedFlat,clientList:e.clientList}}),U)((function(e){var t=e.streets,n=e.houses,c=e.setAllHouses,r=e.flats,s=e.setAllFlats,l=e.selectedFlat,u=e.setSelectedFlat,d=e.clientList,b=e.setClientList,h=e.setAllStreets,j=Object(a.useState)(""),f=Object(o.a)(j,2),O=f[0],x=f[1],g=Object(a.useState)(""),C=Object(o.a)(g,2),S=C[0],w=C[1],E=Object(a.useState)(""),y=Object(o.a)(E,2),k=y[0],T=y[1],F=t.map((function(e){return{label:e.name,id:e.id}})),I=n.map((function(e){return{label:e.name,id:e.id}})),L=r.map((function(e){return{label:e.name,typeName:e.typeName,id:e.id}})),N=0===t.length,A=0===n.length,P=0===r.length;return Object(m.jsxs)("div",{className:"form",children:[Object(m.jsxs)(p.a,{direction:"row",spacing:2,children:[Object(m.jsx)(v,{onOpen:function(){J.getStreets().then((function(e){h(e)}))},loading:N,options:F,onChange:function(e){x(null===e?"":e.label),function(e){e&&J.getHouses(e.id).then((function(e){c(e)}))}(e),u(""),T(""),w(""),b([])},label:"\u0423\u043b\u0438\u0446\u0430"}),Object(m.jsx)(v,{loading:A,options:I,onChange:function(e){w(null===e?"":e.label),function(e){e&&J.getFlats(e.id).then((function(e){s(e)}))}(e),u(""),T(""),b([])},label:"\u0414\u043e\u043c",value:S}),Object(m.jsx)(v,{loading:P,options:L,onChange:function(e){if(null===e)return u(""),T(""),void b([]);var t;u(e),T(e.label),(t=e.id)&&J.getAllTenants(t).then((function(e){200===e.status?b(e.data):b([])}))},renderOptions:function(e,t){if("\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430"===t.typeName)return Object(a.createElement)("li",Object(i.a)(Object(i.a)({},e),{},{key:t.id}),t.label)},label:"\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430",value:k})]}),l?Object(m.jsx)("h4",{style:{fontWeight:500,fontSize:20},children:"\u0416\u0438\u043b\u044c\u0446\u044b ".concat(O," ").concat(S," \u043a\u0432\u0430\u0440\u0442\u0438\u0440\u0430: ").concat(l.label," :")}):null,Object(m.jsx)("div",{className:"personInfo",children:d.map((function(e,t){var n=e.name,a=e.phone,c=e.email,r=e.bindId;return Object(m.jsx)(W,{bindId:r,name:n,phone:a,email:c},t)}))})]})})),M=(n(143),new f),V={setClientList:y},G=Object(k.b)((function(e){return{selectedFlat:e.selectedFlat}}),V)((function(e){var t=e.selectedFlat,n=e.setClientList,c=Object(a.useState)(!1),r=Object(o.a)(c,2),s=r[0],l=r[1],u=Object(a.useState)({Id:0,Name:"",Phone:"",Email:"",BindId:0}),d=Object(o.a)(u,2),b=d[0],h=d[1],j=function(e,a){M.bindPerson(e,a).then((function(){M.getAllTenants(t.id).then((function(e){n(e.data)}))}))},f=function(){l(!1),h({Id:0,Name:"",Phone:"",Email:"",BindId:0}),M.getAllTenants(t.id).then((function(e){n(e.data)}))};return Object(m.jsxs)("div",{children:[Object(m.jsx)(L.a,{variant:"outlined",onClick:function(){l(!0)},sx:{position:"absolute",top:30,right:100},disabled:!t,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"}),Object(m.jsxs)(P.a,{open:s,onClose:f,children:[Object(m.jsx)(R.a,{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(x.a,{id:"outlined-name",label:"\u0424.\u0418.\u041e",sx:{m:1,width:"25ch"},onChange:function(e){h((function(t){return Object(i.a)(Object(i.a)({},t),{},{Name:e.target.value})}))},value:b.Name}),Object(m.jsx)(x.a,{id:"outlined-basic",label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",type:"tel",required:!0,variant:"outlined",sx:{m:1,width:"25ch"},value:b.Phone,onChange:function(e){h((function(t){return Object(i.a)(Object(i.a)({},t),{},{Phone:e.target.value})}))}}),Object(m.jsx)(x.a,{id:"outlined-basic",label:"Email",variant:"outlined",sx:{m:1,width:"25ch"},value:b.Email,onChange:function(e){h((function(t){return Object(i.a)(Object(i.a)({},t),{},{Email:e.target.value})}))}})]}),Object(m.jsxs)(_.a,{children:[Object(m.jsx)(L.a,{onClick:f,children:"Cancel"}),Object(m.jsx)(L.a,{disabled:!b.Phone,onClick:function(){return function(e){M.postPerson(e).then((function(e){j(t.id,e.data.id)})),h({Id:0,Name:"",Phone:"",Email:"",BindId:0}),l(!1)}(b)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]})]})]})})),K=function(){return Object(m.jsxs)("div",{className:"app",children:[Object(m.jsx)(D,{}),Object(m.jsx)(G,{})]})},Q=n(88),X={streets:[],houses:[],flats:[],selectedFlat:"",clientList:[]},Y=Object(Q.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(i.a)(Object(i.a)({},e),{},{streets:t.streets});case C:return Object(i.a)(Object(i.a)({},e),{},{houses:t.houses});case S:return Object(i.a)(Object(i.a)({},e),{},{flats:t.flats});case w:return Object(i.a)(Object(i.a)({},e),{},{selectedFlat:t.selectedFlat});case E:return Object(i.a)(Object(i.a)({},e),{},{clientList:t.clientList});default:return e}})),Z=Y;s.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(k.a,{store:Z,children:Object(m.jsx)(K,{})})}),document.getElementById("root"))}},[[144,1,2]]]);
//# sourceMappingURL=main.e6d6f648.chunk.js.map