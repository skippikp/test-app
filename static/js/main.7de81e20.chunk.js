(this["webpackJsonptest-app"]=this["webpackJsonptest-app"]||[]).push([[0],{114:function(t,e,n){},139:function(t,e,n){},142:function(t,e,n){},143:function(t,e,n){},144:function(t,e,n){"use strict";n.r(e);var a={};n.r(a),n.d(a,"setStreets",(function(){return k})),n.d(a,"setHouses",(function(){return y})),n.d(a,"setFlats",(function(){return I})),n.d(a,"setSelectedFlat",(function(){return P})),n.d(a,"setClientList",(function(){return _}));var r=n(0),c=n.n(r),s=n(26),i=n.n(s),u=(n(114),n(19)),o=n.n(u),l=n(33),d=n(53),b=n(43),j=n.n(b),f=function t(){var e=this;Object(d.a)(this,t),this._apiBase="https://dispex.org/api/vtest",this.getResource=function(){var t=Object(l.a)(o.a.mark((function t(n){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.a.get("".concat(e._apiBase).concat(n));case 2:if(!((a=t.sent).status>=400)){t.next=5;break}throw new Error("Could not fetch ".concat(n,", received ").concat(a.status));case 5:return t.next=7,a;case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.getStreets=Object(l.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getResource("/Request/streets");case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)}))),this.getHouses=function(){var t=Object(l.a)(o.a.mark((function t(n){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getResource("/Request/houses/".concat(n));case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.getFlats=function(){var t=Object(l.a)(o.a.mark((function t(n){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getResource("/Request/house_flats/".concat(n));case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.postPerson=function(){var t=Object(l.a)(o.a.mark((function t(e){var n,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={method:"POST",headers:{"Content-Type":"text/json",accept:"text/plain"},data:e,url:"https://dispex.org/api/vtest/HousingStock/client"},t.next=3,j()(n);case 3:return a=t.sent,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.getAllTenants=function(){var t=Object(l.a)(o.a.mark((function t(e){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.a.get("https://dispex.org/api/vtest/HousingStock/clients?addressId="+e);case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.bindPerson=function(){var t=Object(l.a)(o.a.mark((function t(e,n){var a,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={method:"PUT",headers:{"Content-Type":"text/json",accept:"*/*"},data:{AddressId:e,ClientId:n},url:"https://dispex.org/api/vtest/HousingStock/bind_client"},t.next=3,j()(a).then((function(t){return console.log(t)}));case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.removePerson=function(){var t=Object(l.a)(o.a.mark((function t(e){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.a.delete("https://dispex.org/api/vtest/HousingStock/bind_client/".concat(e));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},h=n(27),O=n(14),p=n(12),x=n(201),v=n(204),m=n(203),S=n(196),g=n(148),E=n(193),T=n(198),C=n(200),w=n(199),F=n(188),L=n(28),k=function(t){return{type:"SET_STREETS",streets:t}},y=function(t){return{type:"SET_HOUSES",houses:t}},I=function(t){return{type:"SET_FLATS",flats:t}},P=function(t){return{type:"SET_SELECTED_FLAT",selectedFlat:t}},_=function(t){return{type:"SET_CLIENT_LIST",clientList:t}},N=(n(139),n(2)),H=new f,A=Object(h.b)((function(t){return{selectedFlat:t.selectedFlat}}),(function(t){var e=Object(L.a)(a,t).setClientList;return{setClientList:function(t){return e(t)}}}))((function(t){var e=t.name,n=t.phone,a=t.email,c=t.bindId,s=t.selectedFlat,i=t.setClientList,u={Id:0,Name:e,Phone:n,Email:a,BindId:0},o=Object(r.useState)(!1),l=Object(p.a)(o,2),d=l[0],b=l[1],j=Object(r.useState)(u),f=Object(p.a)(j,2),h=f[0],L=f[1],k=function(){b(!1),H.getAllTenants(s.id).then((function(t){i(t.data)}))};return Object(N.jsxs)("div",{className:"personInfo",children:[Object(N.jsxs)(x.a,{sx:{minWidth:275,maxWidth:500,minHeight:200},children:[Object(N.jsxs)(m.a,{children:[Object(N.jsx)(g.a,{sx:{fontSize:20},color:"text.secondary",gutterBottom:!0,children:e}),Object(N.jsx)(g.a,{sx:{fontSize:20},color:"green",children:n}),Object(N.jsx)(g.a,{sx:{mb:1.5},color:"text.secondary",children:a})]}),Object(N.jsxs)(v.a,{children:[Object(N.jsx)(S.a,{size:"small",onClick:function(){b(!0),L(u)},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(N.jsx)(S.a,{size:"small",onClick:function(){return t=c,void H.removePerson(t).then((function(){H.getAllTenants(s.id).then((function(t){""!==t.data?i(t.data):i([])}))}));var t},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})]}),Object(N.jsxs)(T.a,{open:d,onClose:k,children:[Object(N.jsx)(F.a,{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"}),Object(N.jsxs)(w.a,{children:[Object(N.jsx)(E.a,{id:"outlined-name",label:"Name",onChange:function(t){L((function(e){return Object(O.a)(Object(O.a)({},e),{},{Name:t.target.value})}))},value:h.Name}),Object(N.jsx)(E.a,{id:"outlined-basic",label:"Email",variant:"outlined",value:h.Email,onChange:function(t){L((function(e){return Object(O.a)(Object(O.a)({},e),{},{Email:t.target.value})}))}})]}),Object(N.jsxs)(C.a,{children:[Object(N.jsx)(S.a,{onClick:k,children:"Cancel"}),Object(N.jsx)(S.a,{onClick:function(){return function(t){H.postPerson(t).then((function(){H.getAllTenants(s.id).then((function(t){i(t.data)}))})),b(!1)}(h)},children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"})]})]})]})})),R=n(191),B=n(192),z=(n(142),new f),q=Object(h.b)((function(t){return{streets:t.streets,houses:t.houses,flats:t.flats,selectedFlat:t.selectedFlat,clientList:t.clientList}}),(function(t){var e=Object(L.a)(a,t),n=e.setHouses,r=e.setFlats,c=e.setSelectedFlat,s=e.setClientList;return{setHouses:function(t){return n(t)},setFlats:function(t){return r(t)},setSelectedFlat:function(t){return c(t)},setClientList:function(t){return s(t)}}}))((function(t){var e=t.streets,n=t.houses,a=t.setHouses,c=t.flats,s=t.setFlats,i=t.selectedFlat,u=t.setSelectedFlat,o=t.clientList,l=t.setClientList,d=Object(r.useState)(""),b=Object(p.a)(d,2),j=b[0],f=b[1],h=Object(r.useState)(""),x=Object(p.a)(h,2),v=x[0],m=x[1];Object(r.useEffect)((function(){S(j),g(v)}),[j,v]);var S=function(t){var n=e.find((function(e){return e.name===t}));n&&z.getHouses(n.id).then((function(t){a(t)}))},g=function(t){var e=n.find((function(e){return e.name===t}));e&&z.getFlats(e.id).then((function(t){s(t)}))},T=function(t){m(t.target.value)},C=function(t){f(t.target.value)},w=function(t){var e,n=null===c||void 0===c?void 0:c.find((function(e){return e.name===t.target.value}));u(n),e=null===n||void 0===n?void 0:n.id,z.getAllTenants(e).then((function(t){200===t.status?l(t.data):l([])})),n||l([])},F=e.map((function(t){return{label:t.name,id:t.id}}));return Object(N.jsxs)("div",{className:"form",children:[Object(N.jsxs)(R.a,{direction:"row",spacing:2,children:[Object(N.jsx)(B.a,{disablePortal:!0,id:"combo-box-demo",options:F,sx:{width:300},renderOption:function(t,e){return Object(r.createElement)("li",Object(O.a)(Object(O.a)({},t),{},{key:e.id}),e.label)},renderInput:function(t){return Object(N.jsx)(E.a,Object(O.a)(Object(O.a)({},t),{},{onSelect:C,label:"\u0423\u043b\u0438\u0446\u0430"}))}}),Object(N.jsx)(B.a,{disablePortal:!0,id:"combo-box-demo",options:n.map((function(t){return{label:t.name,id:t.id}})),sx:{width:300},renderOption:function(t,e){return Object(r.createElement)("li",Object(O.a)(Object(O.a)({},t),{},{key:e.id}),e.label)},renderInput:function(t){return Object(N.jsx)(E.a,Object(O.a)(Object(O.a)({},t),{},{onSelect:T,label:"\u0414\u043e\u043c"}))}}),Object(N.jsx)(B.a,{disablePortal:!0,id:"combo-box-demo",options:c.map((function(t){return{label:t.name,typeName:t.typeName,id:t.id}})),sx:{width:300},renderOption:function(t,e){if("\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430"===e.typeName)return Object(r.createElement)("li",Object(O.a)(Object(O.a)({},t),{},{key:e.id}),e.label)},renderInput:function(t){return Object(N.jsx)(E.a,Object(O.a)(Object(O.a)({},t),{},{onSelect:w,label:"\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430"}))}})]}),i?Object(N.jsx)("h4",{style:{fontWeight:500,fontSize:20},children:"\u0416\u0438\u043b\u044c\u0446\u044b ".concat(j," ").concat(v," ").concat(i.name," :")}):null,Object(N.jsx)("div",{className:"personInfo",children:o.map((function(t,e){var n=t.name,a=t.phone,r=t.email,c=t.bindId;return Object(N.jsx)(A,{bindId:c,name:n,phone:a,email:r},e)}))})]})})),U=(n(143),new f),W=Object(h.b)((function(t){return{selectedFlat:t.selectedFlat}}),(function(t){var e=Object(L.a)(a,t).setClientList;return{setClientList:function(t){return e(t)}}}))((function(t){var e=t.selectedFlat,n=t.setClientList,a=Object(r.useState)(!1),c=Object(p.a)(a,2),s=c[0],i=c[1],u=Object(r.useState)({Id:0,Name:"",Phone:"",Email:"",BindId:0}),o=Object(p.a)(u,2),l=o[0],d=o[1],b=function(t,a){U.bindPerson(t,a).then((function(){U.getAllTenants(e.id).then((function(t){n(t.data)}))}))},j=function(){i(!1),d({Id:0,Name:"",Phone:"",Email:"",BindId:0}),U.getAllTenants(e.id).then((function(t){n(t.data)}))};return Object(N.jsxs)("div",{children:[Object(N.jsx)(S.a,{variant:"outlined",onClick:function(){i(!0)},sx:{position:"absolute",top:30,right:100},disabled:!e,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"}),Object(N.jsxs)(T.a,{open:s,onClose:j,children:[Object(N.jsx)(F.a,{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"}),Object(N.jsxs)(w.a,{children:[Object(N.jsx)(E.a,{id:"outlined-name",label:"\u0424.\u0418.\u041e",sx:{m:1,width:"25ch"},onChange:function(t){d((function(e){return Object(O.a)(Object(O.a)({},e),{},{Name:t.target.value})}))},value:l.Name}),Object(N.jsx)(E.a,{id:"outlined-basic",label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",required:!0,variant:"outlined",sx:{m:1,width:"25ch"},value:l.Phone,onChange:function(t){d((function(e){return Object(O.a)(Object(O.a)({},e),{},{Phone:t.target.value})}))}}),Object(N.jsx)(E.a,{id:"outlined-basic",label:"Outlined",variant:"outlined",sx:{m:1,width:"25ch"},value:l.Email,onChange:function(t){d((function(e){return Object(O.a)(Object(O.a)({},e),{},{Email:t.target.value})}))}})]}),Object(N.jsxs)(C.a,{children:[Object(N.jsx)(S.a,{onClick:j,children:"Cancel"}),Object(N.jsx)(S.a,{disabled:!l.Phone,onClick:function(){return function(t){U.postPerson(t).then((function(t){b(e.id,t.data.id)})),d({Id:0,Name:"",Phone:"",Email:"",BindId:0}),i(!1)}(l)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]})]})]})})),D=new f,J=Object(h.b)((function(t){return{streets:t.streets,houses:t.houses,flats:t.flats}}),(function(t){var e=Object(L.a)(a,t).setStreets;return{setStreets:function(t){return e(t)}}}))((function(t){var e=t.setStreets;Object(r.useEffect)((function(){n()}),[]);var n=function(){D.getStreets().then((function(t){e(t)}))};return Object(N.jsxs)("div",{className:"app",children:[Object(N.jsx)(q,{}),Object(N.jsx)(W,{})]})})),M={streets:[],houses:[],selectedHouse:null,flats:[],selectedFlat:null,clientList:[]},G=Object(L.b)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_STREETS":return Object(O.a)(Object(O.a)({},t),{},{streets:e.streets});case"SET_HOUSES":return Object(O.a)(Object(O.a)({},t),{},{houses:e.houses});case"SET_FLATS":return Object(O.a)(Object(O.a)({},t),{},{flats:e.flats});case"SET_SELECTED_FLAT":return Object(O.a)(Object(O.a)({},t),{},{selectedFlat:e.selectedFlat});case"SET_CLIENT_LIST":return Object(O.a)(Object(O.a)({},t),{},{clientList:e.clientList});default:return t}})),K=G;i.a.render(Object(N.jsx)(c.a.StrictMode,{children:Object(N.jsx)(h.a,{store:K,children:Object(N.jsx)(J,{})})}),document.getElementById("root"))}},[[144,1,2]]]);
//# sourceMappingURL=main.7de81e20.chunk.js.map